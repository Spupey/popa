<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cosmic Miner - Космический тайкун</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Courier New', monospace;
            background-color: #0a0a1a;
            color: #e0e0e0;
            overflow-x: hidden;
        }

        #game-container {
            min-height: 100vh;
            padding: 20px;
            position: relative;
            transition: all 0.5s ease;
            background-size: cover;
            background-position: center;
        }

        /* Времена дня */
        .day {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
        }
        .night {
            background: linear-gradient(135deg, #0a0a1a 0%, #000033 100%);
            color: #b0b0b0;
        }

        /* Погода */
        .clear {
            background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAAOklEQVR42u3OMQEAAAjDMMC/52ECvlRA00lNBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFhQe1ASXRA6UQxYy8AAAAAElFTkSuQmCC');
        }
        .rain {
            background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAAOklEQVR42u3OMQEAAAjDMMC/52ECvlRA00lNBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFhQe1ASXRA6UQxYy8AAAAAElFTkSuQmCC');
        }
        .snow {
            background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAAOklEQVR42u3OMQEAAAjDMMC/52ECvlRA00lNBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFhQe1ASXRA6UQxYy8AAAAAElFTkSuQmCC');
        }
        .sandstorm {
            background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAAOklEQVR42u3OMQEAAAjDMMC/52ECvlRA00lNBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFhQe1ASXRA6UQxYy8AAAAAElFTkSuQmCC');
        }

        /* Времена года */
        .spring .season-effect {
            background: linear-gradient(135deg, rgba(75, 200, 100, 0.1) 0%, transparent 100%);
        }
        .summer .season-effect {
            background: linear-gradient(135deg, rgba(255, 200, 50, 0.1) 0%, transparent 100%);
        }
        .autumn .season-effect {
            background: linear-gradient(135deg, rgba(200, 100, 50, 0.1) 0%, transparent 100%);
        }
        .winter .season-effect {
            background: linear-gradient(135deg, rgba(200, 230, 255, 0.1) 0%, transparent 100%);
        }

        #weather-effects {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }

        #time-of-day {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 2;
            opacity: 0.3;
        }

        #season-indicator {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 3;
            opacity: 0.2;
        }

        #header {
            position: relative;
            z-index: 10;
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(10, 10, 30, 0.7);
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0, 0, 255, 0.3);
        }

        h1 {
            font-family: 'Courier New', monospace;
            font-size: 2.5rem;
            margin-bottom: 20px;
            color: #4fc3f7;
            text-shadow: 0 0 10px rgba(79, 195, 247, 0.7);
        }

        #stats {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .stat {
            background: rgba(20, 20, 50, 0.8);
            padding: 15px 25px;
            border-radius: 8px;
            min-width: 120px;
            box-shadow: 0 0 15px rgba(0, 0, 255, 0.2);
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .stat:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 20px rgba(0, 0, 255, 0.4);
        }

        .stat span {
            display: block;
            text-align: center;
        }

        .stat span:first-child {
            font-size: 1.8rem;
            font-weight: bold;
            color: #4fc3f7;
        }

        .stat-label {
            font-size: 0.9rem;
            color: #a0a0a0;
            margin-top: 5px;
        }

        #main-content {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            position: relative;
            z-index: 10;
            justify-content: center;
        }

        #mine-area {
            flex: 1;
            min-width: 300px;
            max-width: 400px;
            background: rgba(20, 20, 50, 0.7);
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 0 20px rgba(0, 0, 255, 0.3);
            text-align: center;
            position: relative;
        }

        #mine-button {
            background: linear-gradient(135deg, #4fc3f7 0%, #1976d2 100%);
            border: none;
            color: white;
            padding: 20px 40px;
            font-size: 1.5rem;
            border-radius: 50px;
            cursor: pointer;
            font-family: 'Courier New', monospace;
            font-weight: bold;
            box-shadow: 0 5px 15px rgba(0, 0, 255, 0.4);
            transition: all 0.3s;
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
        }

        #mine-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0, 0, 255, 0.6);
        }

        #mine-button:active {
            transform: translateY(1px);
            box-shadow: 0 3px 10px rgba(0, 0, 255, 0.4);
        }

        #mine-button::after {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: rgba(255, 255, 255, 0.1);
            transform: rotate(45deg);
            transition: all 0.5s;
            opacity: 0;
        }

        #mine-button:hover::after {
            opacity: 1;
            top: -30%;
            left: -30%;
        }

        #mine-animation {
            width: 200px;
            height: 200px;
            margin: 0 auto;
            position: relative;
        }

        .ore-image {
            width: 100px;
            height: 100px;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            image-rendering: pixelated;
            transition: transform 0.2s;
        }

        #critical-hit {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 2rem;
            font-weight: bold;
            color: #ffeb3b;
            text-shadow: 0 0 10px #ff5722;
            opacity: 0;
            z-index: 20;
            animation: criticalAnimation 1.5s ease-out;
        }

        @keyframes criticalAnimation {
            0% {
                opacity: 0;
                transform: translate(-50%, -50%) scale(0.5);
            }
            20% {
                opacity: 1;
                transform: translate(-50%, -100%) scale(1.2);
            }
            100% {
                opacity: 0;
                transform: translate(-50%, -200%) scale(1.5);
            }
        }

        #miners-visual {
            position: relative;
            height: 200px;
            margin-top: 20px;
        }

        .miner-visual {
            position: absolute;
            image-rendering: pixelated;
            transition: all 0.5s;
            z-index: 5;
            width: 50px;
            height: 50px;
        }

        #upgrades {
            flex: 2;
            min-width: 300px;
            background: rgba(20, 20, 50, 0.7);
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 0 20px rgba(0, 0, 255, 0.3);
        }

        .upgrades-section {
            margin-bottom: 20px;
        }

        .upgrades-section h2 {
            margin-bottom: 10px;
            display: flex;
            align-items: center;
        }

        .upgrade-items {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 15px;
        }

        .miner, .upgrade {
            background: rgba(30, 30, 60, 0.8);
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #4fc3f7;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }

        .miner:hover, .upgrade:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 255, 0.4);
            background: rgba(40, 40, 80, 0.8);
        }

        .miner-icon, .upgrade-icon {
            width: 32px;
            height: 32px;
            image-rendering: pixelated;
            margin-right: 10px;
            float: left;
        }

        .miner-name {
            font-weight: bold;
            color: #4fc3f7;
            margin-bottom: 5px;
        }

        .miner-stats, .upgrade-stats {
            font-size: 0.9rem;
            color: #a0a0a0;
            margin-bottom: 10px;
            clear: both;
        }

        .miner-cost, .upgrade-cost {
            font-weight: bold;
            color: #ffeb3b;
        }

        .buy-button {
            background: linear-gradient(135deg, #4caf50 0%, #2e7d32 100%);
            border: none;
            color: white;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            margin-top: 10px;
            transition: all 0.3s;
        }

        .buy-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 3px 10px rgba(0, 255, 0, 0.3);
        }

        .buy-button:disabled {
            background: linear-gradient(135deg, #616161 0%, #424242 100%);
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .miner-owned, .upgrade-owned {
            font-size: 0.8rem;
            color: #81c784;
            margin-top: 5px;
        }

        .special-upgrade {
            background: rgba(100, 50, 150, 0.8);
            border-left: 4px solid #9c27b0;
        }

        .special-upgrade:hover {
            background: rgba(120, 70, 170, 0.8);
        }

        #ores-info {
            flex: 1;
            min-width: 300px;
            background: rgba(20, 20, 50, 0.7);
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 0 20px rgba(0, 0, 255, 0.3);
        }

        #ores-log {
            margin-top: 15px;
            max-height: 400px;
            overflow-y: auto;
            padding-right: 10px;
        }

        .ore-log-entry {
            background: rgba(30, 30, 60, 0.5);
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 10px;
            border-left: 3px solid;
            animation: fadeIn 0.5s;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateX(-10px); }
            to { opacity: 1; transform: translateX(0); }
        }

        .ore-log-entry.common {
            border-left-color: #9e9e9e;
        }
        .ore-log-entry.uncommon {
            border-left-color: #4caf50;
        }
        .ore-log-entry.rare {
            border-left-color: #2196f3;
        }
        .ore-log-entry.epic {
            border-left-color: #9c27b0;
        }
        .ore-log-entry.legendary {
            border-left-color: #ff9800;
        }
        .ore-log-entry.mythic {
            border-left-color: #f44336;
        }

        .ore-name {
            font-weight: bold;
        }

        .ore-amount {
            color: #ffeb3b;
            font-weight: bold;
        }

        .ore-time {
            font-size: 0.8rem;
            color: #a0a0a0;
            float: right;
        }

        #notification-center {
            position: fixed;
            top: 20px;
            right: 20px;
            width: 300px;
            z-index: 100;
        }

        .notification {
            background: rgba(20, 20, 50, 0.9);
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 8px;
            border-left: 5px solid #4fc3f7;
            box-shadow: 0 3px 15px rgba(0, 0, 0, 0.3);
            animation: slideIn 0.5s, fadeOut 0.5s 4.5s forwards;
            position: relative;
            overflow: hidden;
        }

        @keyframes slideIn {
            from { transform: translateX(100%); }
            to { transform: translateX(0); }
        }

        @keyframes fadeOut {
            to { opacity: 0; }
        }

        .notification::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: #4fc3f7;
            animation: notificationTimer 5s linear;
        }

        @keyframes notificationTimer {
            from { width: 100%; }
            to { width: 0%; }
        }

        .notification-title {
            font-weight: bold;
            color: #4fc3f7;
            margin-bottom: 5px;
        }

        #prestige {
            margin-top: 30px;
            background: rgba(20, 20, 50, 0.7);
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 0 20px rgba(0, 0, 255, 0.3);
            text-align: center;
        }

        #prestige-button {
            background: linear-gradient(135deg, #ff5722 0%, #e91e63 100%);
            border: none;
            color: white;
            padding: 15px 30px;
            font-size: 1.2rem;
            border-radius: 50px;
            cursor: pointer;
            font-family: 'Courier New', monospace;
            font-weight: bold;
            box-shadow: 0 5px 15px rgba(255, 0, 0, 0.4);
            transition: all 0.3s;
            margin: 15px 0;
        }

        #prestige-button:hover:not(:disabled) {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(255, 0, 0, 0.6);
        }

        #prestige-button:active:not(:disabled) {
            transform: translateY(1px);
            box-shadow: 0 3px 10px rgba(255, 0, 0, 0.4);
        }

        #prestige-button:disabled {
            background: linear-gradient(135deg, #616161 0%, #424242 100%);
            cursor: not-allowed;
        }

        #prestige-bonus {
            font-size: 1.1rem;
            color: #ffeb3b;
        }

        .prestige-perk {
            background: rgba(150, 100, 50, 0.8);
            padding: 10px;
            margin-bottom: 10px;
            border-radius: 5px;
            border-left: 4px solid #ff9800;
        }

        .prestige-perk.unlocked {
            border-left: 4px solid #4caf50;
        }

        .prestige-perk-title {
            font-weight: bold;
            color: #ff9800;
            margin-bottom: 5px;
        }

        .prestige-perk.unlocked .prestige-perk-title {
            color: #4caf50;
        }

        .prestige-perk-description {
            font-size: 0.9rem;
            color: #a0a0a0;
        }

        .prestige-perk-cost {
            font-size: 0.8rem;
            color: #ffeb3b;
            margin-top: 5px;
        }

        /* Анимации погоды */
        .rain-effect {
            position: absolute;
            width: 100%;
            height: 100%;
            background: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAAOklEQVR42u3OMQEAAAjDMMC/52ECvlRA00lNBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFhQe1ASXRA6UQxYy8AAAAAElFTkSuQmCC');
            animation: rain 0.8s linear infinite;
            opacity: 0.6;
        }

        @keyframes rain {
            0% { background-position: 0 0; }
            100% { background-position: 0 100%; }
        }

        .snow-effect {
            position: absolute;
            width: 100%;
            height: 100%;
            background: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAAOklEQVR42u3OMQEAAAjDMMC/52ECvlRA00lNBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFhQe1ASXRA6UQxYy8AAAAAElFTkSuQmCC');
            animation: snow 10s linear infinite;
            opacity: 0.6;
        }

        @keyframes snow {
            0% { background-position: 0 0, 0 0; }
            100% { background-position: 500px 1000px, 300px 800px; }
        }

        .sand-effect {
            position: absolute;
            width: 100%;
            height: 100%;
            background: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAAOklEQVR42u3OMQEAAAjDMMC/52ECvlRA00lNBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFhQe1ASXRA6UQxYy8AAAAAElFTkSuQmCC');
            animation: sand 5s linear infinite;
            opacity: 0.4;
        }

        @keyframes sand {
            0% { background-position: 0 0; }
            100% { background-position: 1000px 0; }
        }

        .day-night-effect {
            position: absolute;
            width: 100%;
            height: 100%;
        }

        .day-effect {
            background: radial-gradient(circle at 20% 50%, rgba(255, 255, 200, 0.1) 0%, transparent 50%);
        }

        .night-effect {
            background: radial-gradient(circle at 80% 30%, rgba(100, 100, 255, 0.05) 0%, transparent 40%);
            box-shadow: inset 0 0 100px rgba(0, 0, 100, 0.3);
        }

        /* Эффекты частиц */
        .particle {
            position: absolute;
            pointer-events: none;
            z-index: 10;
            font-weight: bold;
        }

        /* Анимации для особых эффектов */
        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.1); opacity: 0.8; }
        }

        /* Анимация валюты */
        @keyframes currencyFly {
            0% { transform: translate(0, 0); opacity: 1; }
            100% { transform: translate(var(--tx), -100px); opacity: 0; }
        }

        /* Прокручиваемые списки */
        .scrollable-list {
            max-height: 300px;
            overflow-y: auto;
            padding-right: 10px;
        }

        .scrollable-list::-webkit-scrollbar {
            width: 8px;
        }

        .scrollable-list::-webkit-scrollbar-track {
            background: rgba(20, 20, 50, 0.5);
            border-radius: 4px;
        }

        .scrollable-list::-webkit-scrollbar-thumb {
            background: #4fc3f7;
            border-radius: 4px;
        }

        /* Адаптивность */
        @media (max-width: 768px) {
            #stats {
                flex-direction: column;
                gap: 10px;
            }
            
            .stat {
                width: 100%;
            }
            
            #mine-button {
                padding: 15px 30px;
                font-size: 1.2rem;
            }
            
            h1 {
                font-size: 1.8rem;
            }
        }
    </style>
</head>
<body>
    <div id="game-container" class="day clear">
        <div id="weather-effects"></div>
        <div id="time-of-day"></div>
        <div id="season-indicator"></div>
        
        <div id="header">
            <h1>Cosmic Miner</h1>
            <div id="stats">
                <div class="stat">
                    <span id="ores-count">0</span>
                    <span class="stat-label">Руда</span>
                </div>
                <div class="stat">
                    <span id="ores-per-second">0</span>
                    <span class="stat-label">Руда/сек</span>
                </div>
                <div class="stat">
                    <span id="luck">100%</span>
                    <span class="stat-label">Удача</span>
                </div>
                <div class="stat">
                    <span id="mining-power">1</span>
                    <span class="stat-label">Сила добычи</span>
                </div>
            </div>
        </div>
        
        <div id="main-content">
            <div id="mine-area">
                <button id="mine-button">Добыть руду</button>
                <div id="mine-animation">
                    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAABeSURBVEhL7dXBCYAwDAXQdOQunei5O1Q8eJAPBQ8ePBT8QYgQY0xMfCg8eJBHXvJ4JZkZY4wxxhhjzH+5gK1QrZQq1UqpUq2UKtVKqVKtlCrVSqlSrZQq1UoP5QY8YQZ8xYQmTQAAAABJRU5ErkJggg==" id="current-ore" class="ore-image" alt="Руда">
                </div>
                <div id="critical-hit">CRITICAL HIT!</div>
                <div id="miners-visual"></div>
            </div>
            
            <div id="upgrades">
                <div class="upgrades-section">
                    <h2><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAABeSURBVEhL7dXBCYAwDAXQdOQunei5O1Q8eJAPBQ8ePBT8QYgQY0xMfCg8eJBHXvJ4JZkZY4wxxhhjzH+5gK1QrZQq1UqpUq2UKtVKqVKtlCrVSqlSrZQq1UoP5QY8YQZ8xYQmTQAAAABJRU5ErkJggg==" class="section-icon"> Майнеры</h2>
                    <div id="miners-list" class="upgrade-items scrollable-list"></div>
                </div>
                
                <div class="upgrades-section">
                    <h2><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAABeSURBVEhL7dXBCYAwDAXQdOQunei5O1Q8eJAPBQ8ePBT8QYgQY0xMfCg8eJBHXvJ4JZkZY4wxxhhjzH+5gK1QrZQq1UqpUq2UKtVKqVKtlCrVSqlSrZQq1UoP5QY8YQZ8xYQmTQAAAABJRU5ErkJggg==" class="section-icon"> Улучшения</h2>
                    <div id="upgrades-list" class="upgrade-items scrollable-list"></div>
                </div>
                
                <div class="upgrades-section">
                    <h2><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAABeSURBVEhL7dXBCYAwDAXQdOQunei5O1Q8eJAPBQ8ePBT8QYgQY0xMfCg8eJBHXvJ4JZkZY4wxxhhjzH+5gK1QrZQq1UqpUq2UKtVKqVKtlCrVSqlSrZQq1UoP5QY8YQZ8xYQmTQAAAABJRU5ErkJggg==" class="section-icon"> Особые улучшения</h2>
                    <div id="special-upgrades-list" class="upgrade-items scrollable-list"></div>
                </div>
            </div>
            
            <div id="ores-info">
                <h2><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAABeSURBVEhL7dXBCYAwDAXQdOQunei5O1Q8eJAPBQ8ePBT8QYgQY0xMfCg8eJBHXvJ4JZkZY4wxxhhjzH+5gK1QrZQq1UqpUq2UKtVKqVKtlCrVSqlSrZQq1UoP5QY8YQZ8xYQmTQAAAABJRU5ErkJggg==" class="section-icon"> Инфо о руде</h2>
                <div id="ores-log" class="scrollable-list"></div>
            </div>
        </div>
        
        <div id="notification-center"></div>
        
        <div id="prestige">
            <h2><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAABeSURBVEhL7dXBCYAwDAXQdOQunei5O1Q8eJAPBQ8ePBT8QYgQY0xMfCg8eJBHXvJ4JZkZY4wxxhhjzH+5gK1QrZQq1UqpUq2UKtVKqVKtlCrVSqlSrZQq1UoP5QY8YQZ8xYQmTQAAAABJRU5ErkJggg==" class="section-icon"> Превосходство</h2>
            <button id="prestige-button" disabled>Перерождение (0/1000)</button>
            <p id="prestige-bonus">Бонус перерождения: +0% к добыче</p>
            <div id="prestige-perks" class="scrollable-list"></div>
        </div>
    </div>
    
    <script>
        // Расширенные типы руды с Base64 изображениями
        const oreTypes = {
            iron: { 
                name: "Железо", rarity: "common", baseValue: 1, color: "#9e9e9e", 
                chance: 0.4, luckMultiplier: 1.0, 
                image: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAABeSURBVEhL7dXBCYAwDAXQdOQunei5O1Q8eJAPBQ8ePBT8QYgQY0xMfCg8eJBHXvJ4JZkZY4wxxhhjzH+5gK1QrZQq1UqpUq2UKtVKqVKtlCrVSqlSrZQq1UoP5QY8YQZ8xYQmTQAAAABJRU5ErkJggg==" 
            },
            copper: { 
                name: "Медь", rarity: "common", baseValue: 1.5, color: "#b87333", 
                chance: 0.3, luckMultiplier: 1.1, 
                image: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAABeSURBVEhL7dXBCYAwDAXQdOQunei5O1Q8eJAPBQ8ePBT8QYgQY0xMfCg8eJBHXvJ4JZkZY4wxxhhjzH+5gK1QrZQq1UqpUq2UKtVKqVKtlCrVSqlSrZQq1UoP5QY8YQZ8xYQmTQAAAABJRU5ErkJggg==" 
            },
            tin: { 
                name: "Олово", rarity: "common", baseValue: 2, color: "#a0a0a0", 
                chance: 0.25, luckMultiplier: 1.1, 
                image: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAABeSURBVEhL7dXBCYAwDAXQdOQunei5O1Q8eJAPBQ8ePBT8QYgQY0xMfCg8eJBHXvJ4JZkZY4wxxhhjzH+5gK1QrZQq1UqpUq2UKtVKqVKtlCrVSqlSrZQq1UoP5QY8YQZ8xYQmTQAAAABJRU5ErkJggg==" 
            },
            silver: { 
                name: "Серебро", rarity: "uncommon", baseValue: 5, color: "#c0c0c0", 
                chance: 0.15, unlockRequirement: 100, luckMultiplier: 1.3, 
                image: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAABeSURBVEhL7dXBCYAwDAXQdOQunei5O1Q8eJAPBQ8ePBT8QYgQY0xMfCg8eJBHXvJ4JZkZY4wxxhhjzH+5gK1QrZQq1UqpUq2UKtVKqVKtlCrVSqlSrZQq1UoP5QY8YQZ8xYQmTQAAAABJRU5ErkJggg==" 
            },
            gold: { 
                name: "Золото", rarity: "uncommon", baseValue: 10, color: "#ffd700", 
                chance: 0.1, unlockRequirement: 250, luckMultiplier: 1.5, 
                image: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAABeSURBVEhL7dXBCYAwDAXQdOQunei5O1Q8eJAPBQ8ePBT8QYgQY0xMfCg8eJBHXvJ4JZkZY4wxxhhjzH+5gK1QrZQq1UqpUq2UKtVKqVKtlCrVSqlSrZQq1UoP5QY8YQZ8xYQmTQAAAABJRU5ErkJggg==" 
            },
            platinum: { 
                name: "Платина", rarity: "rare", baseValue: 25, color: "#e5e4e2", 
                chance: 0.07, unlockRequirement: 500, luckMultiplier: 2.0, 
                image: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAABeSURBVEhL7dXBCYAwDAXQdOQunei5O1Q8eJAPBQ8ePBT8QYgQY0xMfCg8eJBHXvJ4JZkZY4wxxhhjzH+5gK1QrZQq1UqpUq2UKtVKqVKtlCrVSqlSrZQq1UoP5QY8YQZ8xYQmTQAAAABJRU5ErkJggg==" 
            },
            titanium: { 
                name: "Титан", rarity: "rare", baseValue: 40, color: "#878681", 
                chance: 0.05, unlockRequirement: 1000, luckMultiplier: 2.2, 
                image: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAABeSURBVEhL7dXBCYAwDAXQdOQunei5O1Q8eJAPBQ8ePBT8QYgQY0xMfCg8eJBHXvJ4JZkZY4wxxhhjzH+5gK1QrZQq1UqpUq2UKtVKqVKtlCrVSqlSrZQq1UoP5QY8YQZ8xYQmTQAAAABJRU5ErkJggg==" 
            },
            uranium: { 
                name: "Уран", rarity: "epic", baseValue: 100, color: "#7cfc00", 
                chance: 0.03, unlockRequirement: 2500, luckMultiplier: 3.0, 
                image: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAABeSURBVEhL7dXBCYAwDAXQdOQunei5O1Q8eJAPBQ8ePBT8QYgQY0xMfCg8eJBHXvJ4JZkZY4wxxhhjzH+5gK1QrZQq1UqpUq2UKtVKqVKtlCrVSqlSrZQq1UoP5QY8YQZ8xYQmTQAAAABJRU5ErkJggg==" 
            },
            palladium: { 
                name: "Палладий", rarity: "epic", baseValue: 200, color: "#ceb180", 
                chance: 0.02, unlockRequirement: 5000, luckMultiplier: 3.5, 
                image: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAABeSURBVEhL7dXBCYAwDAXQdOQunei5O1Q8eJAPBQ8ePBT8QYgQY0xMfCg8eJBHXvJ4JZkZY4wxxhhjzH+5gK1QrZQq1UqpUq2UKtVKqVKtlCrVSqlSrZQq1UoP5QY8YQZ8xYQmTQAAAABJRU5ErkJggg==" 
            },
            mithril: { 
                name: "Мифрил", rarity: "legendary", baseValue: 500, color: "#4b8bff", 
                chance: 0.01, unlockRequirement: 10000, luckMultiplier: 5.0, 
                image: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAABeSURBVEhL7dXBCYAwDAXQdOQunei5O1Q8eJAPBQ8ePBT8QYgQY0xMfCg8eJBHXvJ4JZkZY4wxxhhjzH+5gK1QrZQq1UqpUq2UKtVKqVKtlCrVSqlSrZQq1UoP5QY8YQZ8xYQmTQAAAABJRU5ErkJggg==" 
            },
            adamantite: { 
                name: "Адамантит", rarity: "legendary", baseValue: 1000, color: "#ff4500", 
                chance: 0.005, unlockRequirement: 20000, luckMultiplier: 7.0, 
                image: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAABeSURBVEhL7dXBCYAwDAXQdOQunei5O1Q8eJAPBQ8ePBT8QYgQY0xMfCg8eJBHXvJ4JZkZY4wxxhhjzH+5gK1QrZQq1UqpUq2UKtVKqVKtlCrVSqlSrZQq1UoP5QY8YQZ8xYQmTQAAAABJRU5ErkJggg==" 
            },
            unobtainium: { 
                name: "Недостающий элемент", rarity: "mythic", baseValue: 5000, color: "#ff00ff", 
                chance: 0.001, unlockRequirement: 50000, luckMultiplier: 10.0, 
                image: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAABeSURBVEhL7dXBCYAwDAXQdOQunei5O1Q8eJAPBQ8ePBT8QYgQY0xMfCg8eJBHXvJ4JZkZY4wxxhhjzH+5gK1QrZQq1UqpUq2UKtVKqVKtlCrVSqlSrZQq1UoP5QY8YQZ8xYQmTQAAAABJRU5ErkJggg==" 
            },
            starstone: { 
                name: "Звездный камень", rarity: "mythic", baseValue: 10000, color: "#00ffff", 
                chance: 0.0005, unlockRequirement: 100000, luckMultiplier: 15.0, 
                image: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAABeSURBVEhL7dXBCYAwDAXQdOQunei5O1Q8eJAPBQ8ePBT8QYgQY0xMfCg8eJBHXvJ4JZkZY4wxxhhjzH+5gK1QrZQq1UqpUq2UKtVKqVKtlCrVSqlSrZQq1UoP5QY8YQZ8xYQmTQAAAABJRU5ErkJggg==" 
            },
            blackmatter: { 
                name: "Черная материя", rarity: "mythic", baseValue: 25000, color: "#000000", 
                chance: 0.0001, unlockRequirement: 250000, luckMultiplier: 20.0, 
                image: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAABeSURBVEhL7dXBCYAwDAXQdOQunei5O1Q8eJAPBQ8ePBT8QYgQY0xMfCg8eJBHXvJ4JZkZY4wxxhhjzH+5gK1QrZQq1UqpUq2UKtVKqVKtlCrVSqlSrZQq1UoP5QY8YQZ8xYQmTQAAAABJRU5ErkJggg==" 
            }
        };

        // Майнеры с Base64 изображениями
        const minersData = [
            { 
                id: "basic_miner", name: "Базовый майнер", description: "Добывает 0.1 руды в секунду", 
                baseCost: 10, baseProduction: 0.1, costMultiplier: 1.15, unlockRequirement: 0, 
                image: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAABeSURBVEhL7dXBCYAwDAXQdOQunei5O1Q8eJAPBQ8ePBT8QYgQY0xMfCg8eJBHXvJ4JZkZY4wxxhhjzH+5gK1QrZQq1UqpUq2UKtVKqVKtlCrVSqlSrZQq1UoP5QY8YQZ8xYQmTQAAAABJRU5ErkJggg==", 
                scale: 0.8 
            },
            { 
                id: "advanced_miner", name: "Продвинутый майнер", description: "Добывает 0.5 руды в секунду", 
                baseCost: 50, baseProduction: 0.5, costMultiplier: 1.2, unlockRequirement: 100, 
                image: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAABeSURBVEhL7dXBCYAwDAXQdOQunei5O1Q8eJAPBQ8ePBT8QYgQY0xMfCg8eJBHXvJ4JZkZY4wxxhhjzH+5gK1QrZQq1UqpUq2UKtVKqVKtlCrVSqlSrZQq1UoP5QY8YQZ8xYQmTQAAAABJRU5ErkJggg==", 
                scale: 0.9 
            },
            { 
                id: "professional_miner", name: "Профессиональный майнер", description: "Добывает 2 руды в секунду", 
                baseCost: 200, baseProduction: 2, costMultiplier: 1.25, unlockRequirement: 500, 
                image: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAABeSURBVEhL7dXBCYAwDAXQdOQunei5O1Q8eJAPBQ8ePBT8QYgQY0xMfCg8eJBHXvJ4JZkZY4wxxhhjzH+5gK1QrZQq1UqpUq2UKtVKqVKtlCrVSqlSrZQq1UoP5QY8YQZ8xYQmTQAAAABJRU5ErkJggg==", 
                scale: 1.0 
            },
            { 
                id: "industrial_miner", name: "Промышленный майнер", description: "Добывает 10 руды в секунду", 
                baseCost: 1000, baseProduction: 10, costMultiplier: 1.3, unlockRequirement: 2000, 
                image: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAABeSURBVEhL7dXBCYAwDAXQdOQunei5O1Q8eJAPBQ8ePBT8QYgQY0xMfCg8eJBHXvJ4JZkZY4wxxhhjzH+5gK1QrZQq1UqpUq2UKtVKqVKtlCrVSqlSrZQq1UoP5QY8YQZ8xYQmTQAAAABJRU5ErkJggg==", 
                scale: 1.1 
            },
            { 
                id: "quantum_miner", name: "Квантовый майнер", description: "Добывает 50 руды в секунду", 
                baseCost: 5000, baseProduction: 50, costMultiplier: 1.35, unlockRequirement: 10000, 
                image: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAABeSURBVEhL7dXBCYAwDAXQdOQunei5O1Q8eJAPBQ8ePBT8QYgQY0xMfCg8eJBHXvJ4JZkZY4wxxhhjzH+5gK1QrZQq1UqpUq2UKtVKqVKtlCrVSqlSrZQq1UoP5QY8YQZ8xYQmTQAAAABJRU5ErkJggg==", 
                scale: 1.2 
            },
            { 
                id: "cosmic_miner", name: "Космический майнер", description: "Добывает 200 руды в секунду", 
                baseCost: 20000, baseProduction: 200, costMultiplier: 1.4, unlockRequirement: 50000, 
                image: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAABeSURBVEhL7dXBCYAwDAXQdOQunei5O1Q8eJAPBQ8ePBT8QYgQY0xMfCg8eJBHXvJ4JZkZY4wxxhhjzH+5gK1QrZQq1UqpUq2UKtVKqVKtlCrVSqlSrZQq1UoP5QY8YQZ8xYQmTQAAAABJRU5ErkJggg==", 
                scale: 1.3 
            },
            { 
                id: "singularity_miner", name: "Майнер сингулярности", description: "Добывает 1000 руды в секунду", 
                baseCost: 100000, baseProduction: 1000, costMultiplier: 1.5, unlockRequirement: 200000, 
                image: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAABeSURBVEhL7dXBCYAwDAXQdOQunei5O1Q8eJAPBQ8ePBT8QYgQY0xMfCg8eJBHXvJ4JZkZY4wxxhhjzH+5gK1QrZQq1UqpUq2UKtVKqVKtlCrVSqlSrZQq1UoP5QY8YQZ8xYQmTQAAAABJRU5ErkJggg==", 
                scale: 1.4 
            },
            { 
                id: "reality_miner", name: "Майнер реальности", description: "Добывает 5000 руды в секунду", 
                baseCost: 500000, baseProduction: 5000, costMultiplier: 1.6, unlockRequirement: 1000000, 
                image: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAABeSURBVEhL7dXBCYAwDAXQdOQunei5O1Q8eJAPBQ8ePBT8QYgQY0xMfCg8eJBHXvJ4JZkZY4wxxhhjzH+5gK1QrZQq1UqpUq2UKtVKqVKtlCrVSqlSrZQq1UoP5QY8YQZ8xYQmTQAAAABJRU5ErkJggg==", 
                scale: 1.5 
            }
        ];

        // Основные улучшения с Base64 иконками
        const upgradesData = [
            { 
                id: "pickaxe_upgrade", name: "Улучшение кирки", description: "Увеличивает добычу руды вручную на 50%", 
                baseCost: 100, effect: { clickMultiplier: 0.5 }, costMultiplier: 2, maxLevel: 10, unlockRequirement: 50, 
                icon: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAABeSURBVEhL7dXBCYAwDAXQdOQunei5O1Q8eJAPBQ8ePBT8QYgQY0xMfCg8eJBHXvJ4JZkZY4wxxhhjzH+5gK1QrZQq1UqpUq2UKtVKqVKtlCrVSqlSrZQq1UoP5QY8YQZ8xYQmTQAAAABJRU5ErkJggg==" 
            },
            { 
                id: "luck_upgrade", name: "Улучшение удачи", description: "Увеличивает шанс найти редкую руду на 5%", 
                baseCost: 200, effect: { luckBonus: 5 }, costMultiplier: 2.5, maxLevel: 10, unlockRequirement: 200, 
                icon: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAABeSURBVEhL7dXBCYAwDAXQdOQunei5O1Q8eJAPBQ8ePBT8QYgQY0xMfCg8eJBHXvJ4JZkZY4wxxhhjzH+5gK1QrZQq1UqpUq2UKtVKqVKtlCrVSqlSrZQq1UoP5QY8YQZ8xYQmTQAAAABJRU5ErkJggg==" 
            },
            { 
                id: "miner_efficiency", name: "Эффективность майнеров", description: "Увеличивает производство всех майнеров на 10%", 
                baseCost: 500, effect: { minerMultiplier: 0.1 }, costMultiplier: 3, maxLevel: 5, unlockRequirement: 1000, 
                icon: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAABeSURBVEhL7dXBCYAwDAXQdOQunei5O1Q8eJAPBQ8ePBT8QYgQY0xMfCg8eJBHXvJ4JZkZY4wxxhhjzH+5gK1QrZQq1UqpUq2UKtVKqVKtlCrVSqlSrZQq1UoP5QY8YQZ8xYQmTQAAAABJRU5ErkJggg==" 
            }
        ];

        // Особые улучшения с Base64 иконками
        const specialUpgradesData = [
            { 
                id: "auto_clicker", name: "Автокликер", description: "Автоматически кликает каждые 10 секунд", 
                baseCost: 5000, effect: { autoClick: true }, costMultiplier: 5, maxLevel: 1, unlockRequirement: 5000, 
                icon: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAABeSURBVEhL7dXBCYAwDAXQdOQunei5O1Q8eJAPBQ8ePBT8QYgQY0xMfCg8eJBHXvJ4JZkZY4wxxhhjzH+5gK1QrZQq1UqpUq2UKtVKqVKtlCrVSqlSrZQq1UoP5QY8YQZ8xYQmTQAAAABJRU5ErkJggg==" 
            },
            { 
                id: "ore_doubler", name: "Удвоитель руды", description: "Удваивает всю получаемую руду", 
                baseCost: 10000, effect: { oreMultiplier: 2 }, costMultiplier: 10, maxLevel: 1, unlockRequirement: 10000, 
                icon: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAABeSURBVEhL7dXBCYAwDAXQdOQunei5O1Q8eJAPBQ8ePBT8QYgQY0xMfCg8eJBHXvJ4JZkZY4wxxhhjzH+5gK1QrZQq1UqpUq2UKtVKqVKtlCrVSqlSrZQq1UoP5QY8YQZ8xYQmTQAAAABJRU5ErkJggg==" 
            },
            { 
                id: "critical_booster", name: "Усилитель критов", description: "Увеличивает шанс критического удара до 15%", 
                baseCost: 15000, effect: { criticalChance: 0.15 }, costMultiplier: 15, maxLevel: 1, unlockRequirement: 15000, 
                icon: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAABeSURBVEhL7dXBCYAwDAXQdOQunei5O1Q8eJAPBQ8ePBT8QYgQY0xMfCg8eJBHXvJ4JZkZY4wxxhhjzH+5gK1QrZQq1UqpUq2UKtVKqVKtlCrVSqlSrZQq1UoP5QY8YQZ8xYQmTQAAAABJRU5ErkJggg==" 
            }
        ];

        // Перки перерождения с Base64 иконками
        const prestigePerks = [
            { 
                id: "eternal_miners", name: "Вечные майнеры", description: "Сохраняет 10% ваших майнеров после перерождения", 
                cost: 5, 
                icon: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAABeSURBVEhL7dXBCYAwDAXQdOQunei5O1Q8eJAPBQ8ePBT8QYgQY0xMfCg8eJBHXvJ4JZkZY4wxxhhjzH+5gK1QrZQq1UqpUq2UKtVKqVKtlCrVSqlSrZQq1UoP5QY8YQZ8xYQmTQAAAABJRU5ErkJggg==" 
            },
            { 
                id: "lucky_start", name: "Удачный старт", description: "Начинает игру с 50% удачи", 
                cost: 10, 
                icon: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAABeSURBVEhL7dXBCYAwDAXQdOQunei5O1Q8eJAPBQ8ePBT8QYgQY0xMfCg8eJBHXvJ4JZkZY4wxxhhjzH+5gK1QrZQq1UqpUq2UKtVKqVKtlCrVSqlSrZQq1UoP5QY8YQZ8xYQmTQAAAABJRU5ErkJggg==" 
            },
            { 
                id: "prestige_boost", name: "Ускорение перерождения", description: "Увеличивает бонус перерождения на 25%", 
                cost: 20, 
                icon: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAABeSURBVEhL7dXBCYAwDAXQdOQunei5O1Q8eJAPBQ8ePBT8QYgQY0xMfCg8eJBHXvJ4JZkZY4wxxhhjzH+5gK1QrZQq1UqpUq2UKtVKqVKtlCrVSqlSrZQq1UoP5QY8YQZ8xYQmTQAAAABJRU5ErkJggg==" 
            },
            { 
                id: "unlock_all_ores", name: "Все руды", description: "Начинает игру со всеми разблокированными рудами", 
                cost: 50, 
                icon: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAABeSURBVEhL7dXBCYAwDAXQdOQunei5O1Q8eJAPBQ8ePBT8QYgQY0xMfCg8eJBHXvJ4JZkZY4wxxhhjzH+5gK1QrZQq1UqpUq2UKtVKqVKtlCrVSqlSrZQq1UoP5QY8YQZ8xYQmTQAAAABJRU5ErkJggg==" 
            }
        ];

        // Игровое состояние
        let gameState = {
            ores: 0,
            oresTotal: 0,
            oresPerSecond: 0,
            miningPower: 1,
            prestigePoints: 0,
            prestigeBonus: 0,
            luck: 100,
            miners: [],
            upgrades: [],
            specialUpgrades: [],
            unlockedOres: ['iron'],
            unlockedPerks: [],
            weather: 'clear',
            timeOfDay: 'day',
            season: 'spring',
            lastUpdate: Date.now(),
            visualMiners: []
        };

        // Инициализация игры
        function initGame() {
            loadGame();
            
            // Инициализация майнеров
            minersData.forEach(miner => {
                gameState.miners.push({
                    ...miner,
                    owned: 0,
                    currentCost: miner.baseCost
                });
            });
            
            // Инициализация улучшений
            upgradesData.forEach(upgrade => {
                gameState.upgrades.push({
                    ...upgrade,
                    level: 0,
                    currentCost: upgrade.baseCost
                });
            });
            
            // Инициализация особых улучшений
            specialUpgradesData.forEach(upgrade => {
                gameState.specialUpgrades.push({
                    ...upgrade,
                    level: 0,
                    currentCost: upgrade.baseCost
                });
            });
            
            setupUI();
            setInterval(gameLoop, 1000);
            setInterval(saveGame, 30000);
            setInterval(updateWeatherAndTime, 30000);
            setInterval(autoClick, 10000); // Автокликер
            
            gameState.lastUpdate = Date.now();
        }

        // Настройка интерфейса
        function setupUI() {
            document.getElementById('mine-button').addEventListener('click', mineOre);
            document.getElementById('prestige-button').addEventListener('click', prestige);
            
            updateUI();
            
            // Майнеры
            const minersList = document.getElementById('miners-list');
            gameState.miners.forEach(miner => {
                const minerElement = document.createElement('div');
                minerElement.className = 'miner';
                minerElement.id = `miner-${miner.id}`;
                minerElement.innerHTML = `
                    <img src="${miner.image}" class="miner-icon">
                    <div class="miner-name">${miner.name}</div>
                    <div class="miner-stats">${miner.description}</div>
                    <div class="miner-cost">Цена: <span id="cost-${miner.id}">${formatNumber(miner.currentCost)}</span> руды</div>
                    <button class="buy-button" id="buy-${miner.id}">Купить</button>
                    <div class="miner-owned">Количество: <span id="owned-${miner.id}">0</span></div>
                `;
                minersList.appendChild(minerElement);
                document.getElementById(`buy-${miner.id}`).addEventListener('click', () => buyMiner(miner.id));
            });
            
            // Улучшения
            const upgradesList = document.getElementById('upgrades-list');
            gameState.upgrades.forEach(upgrade => {
                const upgradeElement = document.createElement('div');
                upgradeElement.className = 'upgrade';
                upgradeElement.id = `upgrade-${upgrade.id}`;
                upgradeElement.innerHTML = `
                    <img src="${upgrade.icon}" class="upgrade-icon">
                    <div class="upgrade-name">${upgrade.name} <span id="level-${upgrade.id}">0</span>/${upgrade.maxLevel}</div>
                    <div class="upgrade-stats">${upgrade.description}</div>
                    <div class="upgrade-cost">Цена: <span id="upgrade-cost-${upgrade.id}">${formatNumber(upgrade.currentCost)}</span> руды</div>
                    <button class="buy-button" id="buy-upgrade-${upgrade.id}">Улучшить</button>
                `;
                upgradesList.appendChild(upgradeElement);
                document.getElementById(`buy-upgrade-${upgrade.id}`).addEventListener('click', () => buyUpgrade(upgrade.id));
            });
            
            // Особые улучшения
            const specialUpgradesList = document.getElementById('special-upgrades-list');
            gameState.specialUpgrades.forEach(upgrade => {
                const upgradeElement = document.createElement('div');
                upgradeElement.className = 'upgrade special-upgrade';
                upgradeElement.id = `special-upgrade-${upgrade.id}`;
                upgradeElement.innerHTML = `
                    <img src="${upgrade.icon}" class="upgrade-icon">
                    <div class="upgrade-name">${upgrade.name}</div>
                    <div class="upgrade-stats">${upgrade.description}</div>
                    <div class="upgrade-cost">Цена: <span id="special-upgrade-cost-${upgrade.id}">${formatNumber(upgrade.currentCost)}</span> руды</div>
                    <button class="buy-button" id="buy-special-upgrade-${upgrade.id}">Приобрести</button>
                `;
                specialUpgradesList.appendChild(upgradeElement);
                document.getElementById(`buy-special-upgrade-${upgrade.id}`).addEventListener('click', () => buySpecialUpgrade(upgrade.id));
            });
            
            // Перки перерождения
            const prestigePerksList = document.getElementById('prestige-perks');
            prestigePerks.forEach(perk => {
                const perkElement = document.createElement('div');
                perkElement.className = `prestige-perk ${gameState.unlockedPerks.includes(perk.id) ? 'unlocked' : ''}`;
                perkElement.id = `perk-${perk.id}`;
                perkElement.innerHTML = `
                    <img src="${perk.icon}" class="perk-icon">
                    <div class="prestige-perk-title">${perk.name}</div>
                    <div class="prestige-perk-description">${perk.description}</div>
                    <div class="prestige-perk-cost">Стоимость: ${perk.cost} очков перерождения</div>
                `;
                prestigePerksList.appendChild(perkElement);
                
                if (!gameState.unlockedPerks.includes(perk.id)) {
                    perkElement.addEventListener('click', () => buyPrestigePerk(perk.id));
                }
            });
        }

        // Покупка перка перерождения
        function buyPrestigePerk(perkId) {
            const perk = prestigePerks.find(p => p.id === perkId);
            if (perk && gameState.prestigePoints >= perk.cost && !gameState.unlockedPerks.includes(perkId)) {
                gameState.prestigePoints -= perk.cost;
                gameState.unlockedPerks.push(perkId);
                
                // Применение эффекта перка
                applyPrestigePerk(perkId);
                
                // Обновление интерфейса
                const perkElement = document.getElementById(`perk-${perkId}`);
                perkElement.classList.add('unlocked');
                perkElement.innerHTML = `
                    <img src="${perk.icon}" class="perk-icon">
                    <div class="prestige-perk-title">${perk.name}</div>
                    <div class="prestige-perk-description">${perk.description}</div>
                    <div class="prestige-perk-cost">Активировано</div>
                `;
                
                showNotification(`Перк активирован!`, `Вы получили "${perk.name}"`, '#9c27b0');
                playUnlockSound();
            }
        }

        // Применение эффектов перков
        function applyPrestigePerk(perkId) {
            switch (perkId) {
                case 'lucky_start':
                    gameState.luck = Math.max(gameState.luck, 50);
                    break;
                case 'prestige_boost':
                    gameState.prestigeBonus += 25;
                    break;
                case 'unlock_all_ores':
                    gameState.unlockedOres = Object.keys(oreTypes);
                    break;
            }
        }

        // Покупка особого улучшения
        function buySpecialUpgrade(upgradeId) {
            const upgrade = gameState.specialUpgrades.find(u => u.id === upgradeId);
            
            if (upgrade && upgrade.level < upgrade.maxLevel && gameState.ores >= upgrade.currentCost) {
                gameState.ores -= upgrade.currentCost;
                upgrade.level++;
                
                // Применение эффекта
                if (upgrade.effect.autoClick) {
                    // Автокликер уже работает благодаря setInterval
                }
                if (upgrade.effect.oreMultiplier) {
                    // Множитель применяется в функции добычи
                }
                if (upgrade.effect.criticalChance) {
                    // Шанс крита учитывается в mineOre()
                }
                
                // Обновление интерфейса
                updateUI();
                playBuySound();
                
                // Уведомление
                showNotification(`Улучшение куплено!`, `Вы приобрели "${upgrade.name}"`, '#9c27b0');
            }
        }

        // Автокликер
        function autoClick() {
            const autoClicker = gameState.specialUpgrades.find(u => u.id === 'auto_clicker');
            if (autoClicker && autoClicker.level > 0) {
                mineOre();
            }
        }

        // Обновление визуальных майнеров
        function updateVisualMiners() {
            const container = document.getElementById('miners-visual');
            container.innerHTML = '';
            
            gameState.visualMiners = [];
            
            // Создаем визуальные элементы для каждого майнера
            gameState.miners.forEach(miner => {
                if (miner.owned > 0) {
                    // Создаем несколько визуальных элементов для каждого майнера
                    const count = Math.min(Math.floor(Math.log10(miner.owned + 1)) + 1, 5);
                    
                    for (let i = 0; i < count; i++) {
                        const visualMiner = document.createElement('img');
                        visualMiner.src = miner.image;
                        visualMiner.className = 'miner-visual';
                        visualMiner.style.width = `${miner.scale * 50}px`;
                        visualMiner.style.left = `${10 + Math.random() * 80}%`;
                        visualMiner.style.bottom = `${10 + Math.random() * 20}px`;
                        visualMiner.style.opacity = '0.8';
                        visualMiner.style.animation = `float ${3 + Math.random() * 4}s infinite ease-in-out`;
                        
                        container.appendChild(visualMiner);
                        gameState.visualMiners.push(visualMiner);
                    }
                }
            });
        }

        // Обновление изображения руды
        function updateOreImage(oreType) {
            const oreImage = document.getElementById('current-ore');
            if (oreImage) {
                oreImage.src = oreType.image;
                oreImage.style.animation = 'pulse 0.5s';
                setTimeout(() => {
                    oreImage.style.animation = '';
                }, 500);
            }
        }

        // Эффект летающей валюты
        function createCurrencyParticles(amount, x, y) {
            for (let i = 0; i < Math.min(10, amount); i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.textContent = '+1';
                particle.style.color = '#ffeb3b';
                particle.style.left = `${x}px`;
                particle.style.top = `${y}px`;
                particle.style.fontWeight = 'bold';
                particle.style.setProperty('--tx', `${Math.random() * 200 - 100}px`);
                particle.style.animation = `currencyFly ${0.5 + Math.random()}s forwards`;
                
                document.getElementById('game-container').appendChild(particle);
                
                setTimeout(() => {
                    particle.remove();
                }, 1000);
            }
        }

        // Добыча руды с эффектами
        function mineOre() {
            let oreGain = gameState.miningPower;
            
            // Применение улучшений кирки
            const pickaxeUpgrade = gameState.upgrades.find(u => u.id === 'pickaxe_upgrade');
            if (pickaxeUpgrade) {
                oreGain *= (1 + pickaxeUpgrade.level * pickaxeUpgrade.effect.clickMultiplier);
            }
            
            // Применение бонуса перерождения
            oreGain *= (1 + gameState.prestigeBonus / 100);
            
            // Применение особых улучшений
            const oreDoubler = gameState.specialUpgrades.find(u => u.id === 'ore_doubler');
            if (oreDoubler && oreDoubler.level > 0) {
                oreGain *= oreDoubler.effect.oreMultiplier;
            }
            
            // Шанс критического удара
            let criticalChance = 0.05;
            const luckUpgrade = gameState.upgrades.find(u => u.id === 'luck_upgrade');
            if (luckUpgrade) {
                criticalChance += luckUpgrade.level * 0.01;
            }
            
            const criticalBooster = gameState.specialUpgrades.find(u => u.id === 'critical_booster');
            if (criticalBooster && criticalBooster.level > 0) {
                criticalChance = criticalBooster.effect.criticalChance;
            }
            
            const isCritical = Math.random() < criticalChance;
            if (isCritical) {
                oreGain *= 5;
                showCriticalHit();
            }
            
            // Определение типа руды
            const oreType = determineOreType(isCritical);
            updateOreImage(oreType);
            
            // Добавление руды
            const actualOre = oreType.baseValue * oreGain;
            gameState.ores += actualOre;
            gameState.oresTotal += actualOre;
            
            // Эффект частиц
            const buttonRect = document.getElementById('mine-button').getBoundingClientRect();
            createCurrencyParticles(actualOre, buttonRect.left + buttonRect.width/2, buttonRect.top);
            
            // Обновление удачи
            updateLuck(oreType);
            
            // Логирование добычи
            logOreMined(oreType, actualOre, isCritical);
            
            // Обновление интерфейса
            updateUI();
            
            // Воспроизведение звука
            playMineSound(isCritical);
            
            // Анимация добычи
            animateMining();
        }

        // Определение типа руды
        function determineOreType(isCritical) {
            // Увеличение шансов при критическом ударе
            const luckMultiplier = isCritical ? 2 : 1;
            
            // Создание массива возможных руд с учетом шансов
            let possibleOres = [];
            for (const [id, ore] of Object.entries(oreTypes)) {
                if (gameState.unlockedOres.includes(id)) {
                    const adjustedChance = ore.chance * luckMultiplier * (1 + gameState.luck / 100 * ore.luckMultiplier);
                    possibleOres.push({ id, adjustedChance });
                }
            }
            
            // Сортировка по шансу (от меньшего к большему)
            possibleOres.sort((a, b) => a.adjustedChance - b.adjustedChance);
            
            // Выбор руды
            let random = Math.random();
            for (const ore of possibleOres) {
                if (random < ore.adjustedChance) {
                    return oreTypes[ore.id];
                }
                random -= ore.adjustedChance;
            }
            
            // Если ничего не выбрано (маловероятно), вернуть железо
            return oreTypes.iron;
        }

        // Обновление удачи
        function updateLuck(oreType) {
            // Базовое изменение удачи в зависимости от редкости руды
            let luckChange = 0;
            switch (oreType.rarity) {
                case 'common': luckChange = -1; break;
                case 'uncommon': luckChange = 0; break;
                case 'rare': luckChange = 2; break;
                case 'epic': luckChange = 5; break;
                case 'legendary': luckChange = 10; break;
                case 'mythic': luckChange = 20; break;
            }
            
            // Применение изменения с ограничениями
            gameState.luck = Math.max(0, Math.min(200, gameState.luck + luckChange));
        }

        // Покупка майнера
        function buyMiner(minerId) {
            const miner = gameState.miners.find(m => m.id === minerId);
            
            if (miner && gameState.ores >= miner.currentCost) {
                gameState.ores -= miner.currentCost;
                miner.owned++;
                miner.currentCost = Math.floor(miner.baseCost * Math.pow(miner.costMultiplier, miner.owned));
                
                // Обновление интерфейса
                updateUI();
                playBuySound();
                updateVisualMiners();
            }
        }

        // Покупка улучшения
        function buyUpgrade(upgradeId) {
            const upgrade = gameState.upgrades.find(u => u.id === upgradeId);
            
            if (upgrade && upgrade.level < upgrade.maxLevel && gameState.ores >= upgrade.currentCost) {
                gameState.ores -= upgrade.currentCost;
                upgrade.level++;
                
                // Обновление стоимости
                if (upgrade.level < upgrade.maxLevel) {
                    upgrade.currentCost = Math.floor(upgrade.baseCost * Math.pow(upgrade.costMultiplier, upgrade.level));
                }
                
                // Обновление интерфейса
                updateUI();
                playBuySound();
            }
        }

        // Автоматическая добыча
        function autoMine() {
            let totalProduction = 0;
            
            // Производство каждого майнера
            gameState.miners.forEach(miner => {
                if (miner.owned > 0) {
                    let production = miner.baseProduction * miner.owned;
                    
                    // Применение улучшений эффективности
                    const efficiencyUpgrade = gameState.upgrades.find(u => u.id === 'miner_efficiency');
                    if (efficiencyUpgrade) {
                        production *= (1 + efficiencyUpgrade.level * efficiencyUpgrade.effect.minerMultiplier);
                    }
                    
                    // Применение бонуса перерождения
                    production *= (1 + gameState.prestigeBonus / 100);
                    
                    totalProduction += production;
                }
            });
            
            // Добавление руды
            if (totalProduction > 0) {
                gameState.ores += totalProduction;
                gameState.oresTotal += totalProduction;
                gameState.oresPerSecond = totalProduction;
                
                // Логирование автоматической добычи (редко)
                if (Math.random() < 0.05) {
                    const oreType = determineOreType(false);
                    logOreMined(oreType, totalProduction / 10, false, true);
                }
            }
        }

        // Перерождение
        function prestige() {
            if (gameState.oresTotal >= 1000) {
                // Расчет очков перерождения
                const points = Math.floor(Math.sqrt(gameState.oresTotal / 1000));
                
                // Обновление состояния
                gameState.prestigePoints += points;
                
                // Применение перка "Вечные майнеры"
                const eternalMiners = gameState.unlockedPerks.includes('eternal_miners');
                let minersToKeep = {};
                
                if (eternalMiners) {
                    gameState.miners.forEach(miner => {
                        minersToKeep[miner.id] = Math.floor(miner.owned * 0.1);
                    });
                }
                
                // Сброс игры
                gameState.ores = 0;
                gameState.oresTotal = 0;
                gameState.oresPerSecond = 0;
                gameState.miningPower = 1;
                gameState.luck = gameState.unlockedPerks.includes('lucky_start') ? 50 : 100;
                
                // Сброс майнеров с учетом перков
                gameState.miners.forEach(miner => {
                    miner.owned = eternalMiners ? minersToKeep[miner.id] || 0 : 0;
                    miner.currentCost = miner.baseCost * Math.pow(miner.costMultiplier, miner.owned);
                });
                
                // Сброс улучшений (кроме особых)
                gameState.upgrades.forEach(upgrade => {
                    upgrade.level = 0;
                    upgrade.currentCost = upgrade.baseCost;
                });
                
                // Разблокировка руды с учетом перков
                gameState.unlockedOres = gameState.unlockedPerks.includes('unlock_all_ores') ? 
                    Object.keys(oreTypes) : ['iron'];
                
                // Уведомление
                showNotification(`Перерождение успешно!`, `Вы получили ${points} очков перерождения.`, '#ff9800');
                playPrestigeSound();
                
                // Обновление интерфейса
                updateUI();
                updateVisualMiners();
            }
        }

        // Проверка разблокировки контента
        function checkUnlocks() {
            // Разблокировка руды
            for (const [id, ore] of Object.entries(oreTypes)) {
                if (ore.unlockRequirement && !gameState.unlockedOres.includes(id) && gameState.oresTotal >= ore.unlockRequirement) {
                    gameState.unlockedOres.push(id);
                    showNotification(`Новая руда разблокирована!`, `${ore.name} теперь может быть найдена при добыче.`, ore.color);
                    playUnlockSound();
                }
            }
            
            // Разблокировка майнеров
            gameState.miners.forEach(miner => {
                const element = document.getElementById(`miner-${miner.id}`);
                if (element) {
                    if (gameState.oresTotal >= miner.unlockRequirement) {
                        element.style.display = 'block';
                    } else {
                        element.style.display = 'none';
                    }
                }
            });
            
            // Разблокировка улучшений
            gameState.upgrades.forEach(upgrade => {
                const element = document.getElementById(`upgrade-${upgrade.id}`);
                if (element) {
                    if (gameState.oresTotal >= upgrade.unlockRequirement) {
                        element.style.display = 'block';
                    } else {
                        element.style.display = 'none';
                    }
                }
            });
            
            // Разблокировка особых улучшений
            gameState.specialUpgrades.forEach(upgrade => {
                const element = document.getElementById(`special-upgrade-${upgrade.id}`);
                if (element) {
                    if (gameState.oresTotal >= upgrade.unlockRequirement) {
                        element.style.display = 'block';
                    } else {
                        element.style.display = 'none';
                    }
                }
            });
        }

        // Обновление погоды и времени
        function updateWeatherAndTime() {
            // Смена времени суток (50% шанс)
            if (Math.random() < 0.5) {
                gameState.timeOfDay = gameState.timeOfDay === 'day' ? 'night' : 'day';
                updateTimeOfDayEffects();
            }
            
            // Смена погоды (30% шанс)
            if (Math.random() < 0.3) {
                const weatherTypes = ['clear', 'rain', 'snow', 'sandstorm'];
                gameState.weather = weatherTypes[Math.floor(Math.random() * weatherTypes.length)];
                updateWeatherEffects();
            }
            
            // Смена сезона (каждые 10 минут)
            if (Math.random() < 0.1) {
                const seasons = ['spring', 'summer', 'autumn', 'winter'];
                const currentIndex = seasons.indexOf(gameState.season);
                gameState.season = seasons[(currentIndex + 1) % seasons.length];
                updateSeasonEffects();
            }
        }

        // Обновление эффектов времени суток
        function updateTimeOfDayEffects() {
            const gameContainer = document.getElementById('game-container');
            gameContainer.classList.remove('day', 'night');
            gameContainer.classList.add(gameState.timeOfDay);
            
            // Удаление старых эффектов
            const oldEffects = document.querySelectorAll('.day-night-effect');
            oldEffects.forEach(effect => effect.remove());
            
            // Добавление новых эффектов
            const timeEffect = document.createElement('div');
            timeEffect.className = 'day-night-effect';
            timeEffect.classList.add(`${gameState.timeOfDay}-effect`);
            document.getElementById('weather-effects').appendChild(timeEffect);
        }

        // Обновление эффектов погоды
        function updateWeatherEffects() {
            const gameContainer = document.getElementById('game-container');
            gameContainer.classList.remove('clear', 'rain', 'snow', 'sandstorm');
            gameContainer.classList.add(gameState.weather);
            
            // Удаление старых эффектов
            const oldEffects = document.querySelectorAll('.weather-particle-effect');
            oldEffects.forEach(effect => effect.remove());
            
            // Добавление новых эффектов
            if (gameState.weather !== 'clear') {
                const weatherEffect = document.createElement('div');
                weatherEffect.className = `weather-particle-effect ${gameState.weather}-effect`;
                document.getElementById('weather-effects').appendChild(weatherEffect);
            }
            
            // Уведомление о смене погоды
            let weatherName;
            switch (gameState.weather) {
                case 'clear': weatherName = 'Ясно'; break;
                case 'rain': weatherName = 'Дождь'; break;
                case 'snow': weatherName = 'Снег'; break;
                case 'sandstorm': weatherName = 'Песчаная буря'; break;
            }
            showNotification(`Погода изменилась`, `Сейчас ${weatherName.toLowerCase()}!`, '#4fc3f7');
        }

        // Обновление эффектов сезона
        function updateSeasonEffects() {
            const gameContainer = document.getElementById('game-container');
            gameContainer.classList.remove('spring', 'summer', 'autumn', 'winter');
            gameContainer.classList.add(gameState.season);
            
            // Удаление старых эффектов
            const oldEffects = document.querySelectorAll('.season-effect');
            oldEffects.forEach(effect => effect.remove());
            
            // Добавление новых эффектов
            const seasonEffect = document.createElement('div');
            seasonEffect.className = 'season-effect';
            document.getElementById('season-indicator').appendChild(seasonEffect);
            
            // Уведомление о смене сезона
            let seasonName;
            switch (gameState.season) {
                case 'spring': seasonName = 'Весна'; break;
                case 'summer': seasonName = 'Лето'; break;
                case 'autumn': seasonName = 'Осень'; break;
                case 'winter': seasonName = 'Зима'; break;
            }
            showNotification(`Смена сезона`, `Наступила ${seasonName.toLowerCase()}!`, '#4fc3f7');
        }

        // Показать критический удар
        function showCriticalHit() {
            const criticalElement = document.getElementById('critical-hit');
            criticalElement.style.opacity = '1';
            criticalElement.style.animation = 'none';
            void criticalElement.offsetWidth; // Trigger reflow
            criticalElement.style.animation = 'criticalAnimation 1.5s ease-out';
            
            // Воспроизведение звука
            playCriticalSound();
        }

        // Анимация добычи
        function animateMining() {
            const mineAnimation = document.getElementById('mine-animation');
            mineAnimation.style.transform = 'scale(0.95)';
            mineAnimation.style.transition = 'transform 0.1s';
            
            setTimeout(() => {
                mineAnimation.style.transform = 'scale(1)';
            }, 100);
        }

        // Логирование добычи руды
        function logOreMined(oreType, amount, isCritical = false, isAuto = false) {
            const logElement = document.getElementById('ores-log');
            const logEntry = document.createElement('div');
            logEntry.className = `ore-log-entry ${oreType.rarity}`;
            
            const now = new Date();
            const timeString = now.toLocaleTimeString();
            
            logEntry.innerHTML = `
                <span class="ore-name" style="color: ${oreType.color}">${oreType.name} ${isCritical ? '⭐' : ''} ${isAuto ? '⚙️' : ''}</span>
                <span class="ore-amount">+${formatNumber(amount)}</span>
                <span class="ore-time">${timeString}</span>
            `;
            
            logElement.insertBefore(logEntry, logElement.firstChild);
            
            // Ограничение количества записей
            if (logElement.children.length > 50) {
                logElement.removeChild(logElement.lastChild);
            }
        }

        // Показать уведомление
        function showNotification(title, message, color = '#4fc3f7') {
            const notificationCenter = document.getElementById('notification-center');
            const notification = document.createElement('div');
            notification.className = 'notification';
            notification.style.borderLeftColor = color;
            
            notification.innerHTML = `
                <div class="notification-title">${title}</div>
                <div class="notification-message">${message}</div>
            `;
            
            notificationCenter.insertBefore(notification, notificationCenter.firstChild);
            
            // Автоматическое удаление через 5 секунд
            setTimeout(() => {
                notification.remove();
            }, 5000);
        }

        // Игровой цикл
        function gameLoop() {
            // Автоматическая добыча
            autoMine();
            
            // Проверка разблокировки контента
            checkUnlocks();
            
            // Обновление интерфейса
            updateUI();
            
            // Сохранение времени последнего обновления
            gameState.lastUpdate = Date.now();
        }

        // Обновление интерфейса
        function updateUI() {
            document.getElementById('ores-count').textContent = formatNumber(gameState.ores);
            document.getElementById('ores-per-second').textContent = formatNumber(gameState.oresPerSecond);
            document.getElementById('luck').textContent = `${Math.floor(gameState.luck)}%`;
            document.getElementById('mining-power').textContent = formatNumber(gameState.miningPower);
            
            // Майнеры
            gameState.miners.forEach(miner => {
                document.getElementById(`owned-${miner.id}`).textContent = miner.owned;
                document.getElementById(`cost-${miner.id}`).textContent = formatNumber(miner.currentCost);
                
                const buyButton = document.getElementById(`buy-${miner.id}`);
                buyButton.disabled = gameState.ores < miner.currentCost;
            });
            
            // Улучшения
            gameState.upgrades.forEach(upgrade => {
                document.getElementById(`level-${upgrade.id}`).textContent = upgrade.level;
                document.getElementById(`upgrade-cost-${upgrade.id}`).textContent = formatNumber(upgrade.currentCost);
                
                const buyButton = document.getElementById(`buy-upgrade-${upgrade.id}`);
                buyButton.disabled = gameState.ores < upgrade.currentCost || upgrade.level >= upgrade.maxLevel;
                
                if (upgrade.level >= upgrade.maxLevel) {
                    buyButton.textContent = 'Макс. уровень';
                }
            });
            
            // Особые улучшения
            gameState.specialUpgrades.forEach(upgrade => {
                document.getElementById(`special-upgrade-cost-${upgrade.id}`).textContent = formatNumber(upgrade.currentCost);
                
                const buyButton = document.getElementById(`buy-special-upgrade-${upgrade.id}`);
                buyButton.disabled = gameState.ores < upgrade.currentCost || upgrade.level >= upgrade.maxLevel;
                
                if (upgrade.level >= upgrade.maxLevel) {
                    buyButton.textContent = 'Куплено';
                }
            });
            
            // Кнопка перерождения
            const prestigeButton = document.getElementById('prestige-button');
            prestigeButton.disabled = gameState.oresTotal < 1000;
            prestigeButton.textContent = `Перерождение (${Math.floor(gameState.oresTotal/1000)}/1000)`;
            document.getElementById('prestige-bonus').textContent = `Бонус перерождения: +${gameState.prestigeBonus}% к добыче`;
            
            // Обновление визуальных майнеров
            updateVisualMiners();
        }

        // Форматирование чисел
        function formatNumber(num) {
            if (num >= 1000000) {
                return (num / 1000000).toFixed(2) + 'M';
            }
            if (num >= 1000) {
                return (num / 1000).toFixed(1) + 'K';
            }
            return Math.floor(num).toString();
        }

        // Сохранение игры
        function saveGame() {
            localStorage.setItem('cosmicMinerSave', JSON.stringify(gameState));
            showNotification('Игра сохранена', 'Ваш прогресс был автоматически сохранен.', '#4caf50');
        }

        // Загрузка игры
        function loadGame() {
            const save = localStorage.getItem('cosmicMinerSave');
            if (save) {
                const parsed = JSON.parse(save);
                Object.assign(gameState, parsed);
                showNotification('Игра загружена', 'Ваш прогресс был успешно загружен.', '#4caf50');
            }
        }

        // Воспроизведение звуков
        function playMineSound(isCritical) {
            // В реальной игре здесь был бы звук
            if (isCritical) {
                // Критический звук
            } else {
                // Обычный звук добычи
            }
        }

        function playCriticalSound() {
            // В реальной игре здесь был бы звук крита
        }

        function playBuySound() {
            // В реальной игре здесь был бы звук покупки
        }

        function playUnlockSound() {
            // В реальной игре здесь был бы звук разблокировки
        }

        function playPrestigeSound() {
            // В реальной игре здесь был бы звук перерождения
        }

        // Запуск игры при загрузке страницы
        window.onload = initGame;
    </script>
</body>
</html>
